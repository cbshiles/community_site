    <T extends HasMemId & HasDate> void labAndVisitAction(EocMap gmap, Map<String,List<String>> codes, EocAction ea,
    		int measureYear, Integer minAge, int maxAge, boolean excludeSupp) {
        LocalDate startDate = LocalDate.of(measureYear-maxAge+minAge, 1, 1);
        LocalDate endDate = LocalDate.of(measureYear, 12, 31);
        List<T> labsAndVisits = new ArrayList<T>();
        labsAndVisits.addAll( (List<T>) codeCheckDao.generalLabLookup(codes, startDate, endDate, excludeSupp));
        labsAndVisits.addAll((List<T>)codeCheckDao.generalVisitLookup(codes, startDate, endDate, excludeSupp));
        for(T lab : labsAndVisits) {
            EocMember em = gmap.get(lab.getMemId());
            if (em != null && LocalDateUtil.onOrBetween(em.gm.getDob(), minAge, maxAge, lab.getDate()))
                gmap.memberAction(em, ea);
        }
    }
   